<!DOCTYPE html>
<html>
    <head>
        <title>VIDEOS</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="sport_display.css">
    </head>
    <body>
        <div class="coach-header">
            <div class="coachd">
              <h3 id="sportName" class="name">Videos</h3>
            </div>
            <div class="navigation">
                <ul>
                  <li class="list active">
                    <a href="#">
                      <span class="icon">
                        <ion-icon name="home-outline"></ion-icon>
                      </span>
                      <span class="text">Home</span>
                    </a>
                  </li>
                  <li class="list">
                    <a id="profile" href="#">
                      <span class="icon">
                        <ion-icon name="person-outline"></ion-icon>
                      </span>
                      <span class="text">Profile</span>
                    </a>
                  </li>
                  <li class="list">
                    <a  href="#">
                      <span class="icon">
                        <ion-icon name="log-out-outline"></ion-icon>
                      </span>
                      <span class="text">LOGOUT</span>
                    </a>
                  </li>
                  <div class="indicator"></div>
                </ul>
            </div>   
          </div>

          <div class="main">
            <div class="coach_name_dis">
              <h1 id="cname">LOREM</h1>
            </div>
            <div id="video-container"></div>

            <div class="btn-teamUp">
              <button id="teamUpButton">Team Up</button>
            </div>
          </div>


    </body>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
      <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
      <script>
        const list = document.querySelectorAll(".list");

        function activeLink() {
        list.forEach((item) => item.classList.remove("active"));
        this.classList.add("active");
        }
        list.forEach((item) => item.addEventListener("click", activeLink));
        
        window.onload = function () {
        fetch('/coach_videos', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json'
        }
        })
        .then(response => response.json())
        .then(videos => {

            
            const videoContainer = document.getElementById('video-container');
            videoContainer.innerHTML = '';

            const cname = document.getElementById('cname').innerHTML = videos[0].name;

            videos.forEach(video => {
            const videoDiv = document.createElement('div');
            const titleHeading = document.createElement('h3');
            titleHeading.textContent = video.title;
            titleHeading.style.display = "inline";
            videoDiv.appendChild(titleHeading);
            
            const descParagraph = document.createElement('p');
            descParagraph.textContent = video.description;
            descParagraph.style.display = "inline";
            videoDiv.appendChild(descParagraph);

            const videoElement = document.createElement('video');
            videoElement.src = video.url; 
            videoElement.width = '540';
            videoElement.height = '360';
            videoElement.autoplay = false; 
            videoElement.controls = true; 
            videoDiv.appendChild(videoElement);
            videoDiv.style.width = "600";
            videoDiv.style.display = "flex";
            videoDiv.style.flexDirection = "column";
            videoContainer.appendChild(videoDiv);
                
            });
        })
        .catch(error => {
            console.error('Error retrieving videos:', error);
        });

        fetch('/checkMember',{
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        })
        .then(response => response.json())
        .then(data => {
          console.log(data.message);
          if(data.message === 1)
          {
            const teamUpButton = document.getElementById('teamUpButton');
            teamUpButton.textContent = 'Teamed Up';
          }
        })
        .catch(error => {
          console.error('Error:', error);
        });
        
    }

      // JavaScript code for handling the "Team Up" button click
      const teamUpButton = document.getElementById('teamUpButton');
      teamUpButton.addEventListener('click', () => {
        
        const data ={
           coach_name : document.getElementById('cname').innerHTML
        };

        fetch('/teamup', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        })
          .then(response => response.json())
          .then(data => {
            console.log(data.message);

            if(data.message === 'Team up successful')
            {
              teamUpButton.textContent = 'Teamed Up';
            }
            else
            {
              teamUpButton.textContent = 'Team Up';
            }

          })
          .catch(error => {
            console.error('Error:', error);

          });
      });


    </script>
</html>